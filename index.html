<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Дмитрий Костюк — Иллюзионист</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --gold:#c0a062;
      --bronze:#a18041;
    }
    body{
      font-family:'Roboto',sans-serif;
      background:#000;
      color:#fff;
      cursor:none;                 /* как у тебя было */
      transition:background-color .3s ease;
      background-image:url('background-logo-mobile.jpeg');
      background-position:center center;
      background-repeat:no-repeat;
      background-size:cover;
      background-attachment:fixed;
    }
    @media (min-width:768px){
      body{ background-image:url('background-logo.jpeg'); }
    }

    /* магический курсор */
    #magic-cursor{
      position:fixed; width:20px;height:20px; border:2px solid var(--gold);
      border-radius:50%; pointer-events:none; transform:translate(-50%,-50%);
      transition:width .2s,height .2s; z-index:9999;
    }
    .trail-particle{
      position:fixed; background:var(--gold); border-radius:50%;
      pointer-events:none; z-index:9998; animation:fadeAndScale .7s forwards;
    }
    @keyframes fadeAndScale{ to{ transform:scale(0); opacity:0; } }
    body:has(button:hover) #magic-cursor{ width:40px;height:40px; }

    h1,h2,h3,.torn-paper-button,.modal-card{ font-family:'Playfair Display',serif; }

    /* твоя «рваная» кнопка */
    .torn-paper-button{
      background:linear-gradient(145deg,var(--gold),var(--bronze));
      color:#1a1a1a; border:none; padding:1rem 2rem; font-weight:700; font-size:1.25rem;
      cursor:none; position:relative; transition:transform .3s, box-shadow .3s, background .3s, color .3s;
      text-shadow:1px 1px 3px rgba(0,0,0,.4); clip-path:url(#torn-paper-shape);
    }
    .torn-paper-button:hover{ transform:scale(1.05); box-shadow:0 10px 20px rgba(200,160,90,.2); }

    .button-inverted{
      background:#1a1a1a; color:var(--gold); border:2px solid var(--bronze);
      text-shadow:0 2px 4px rgba(0,0,0,.5), 0 0 15px rgba(192,160,98,.4);
    }
    .button-inverted:hover{
      background:linear-gradient(145deg,var(--gold),var(--bronze)); color:#1a1a1a; border-color:transparent;
    }

    /* появление главных кнопок на десктопе */
    .desktop-button-animation{ opacity:0; transform:translateY(20px); animation:fadeIn 1s ease-out 5s forwards, pulse 2.5s infinite 6s; }
    @keyframes fadeIn{ to{ opacity:1; transform:translateY(0); } }
    @keyframes pulse{ 0%,100%{ transform:scale(1); } 50%{ transform:scale(1.03); } }
    .delay-1{ animation-delay:5.0s,6.0s; }
    .delay-2{ animation-delay:5.2s,6.2s; }
    .delay-3{ animation-delay:5.4s,6.4s; }

    .footer-button{ padding:.5rem 1.5rem; font-size:1rem; animation:pulse 2.5s infinite; }

    /* мобильное меню (слайд) */
    #mobile-menu{ transform:translateY(-100%); transition:transform .5s cubic-bezier(.77,0,.175,1); }
    #mobile-menu.active{ transform:translateY(0); }

    /* модалки */
    .modal{ display:none; opacity:0; transition:opacity .4s ease; }
    .modal.active{ display:flex; opacity:1; }
    .modal-card{
      background:linear-gradient(145deg,var(--gold),var(--bronze)); color:#000; font-weight:700; text-align:center;
      position:relative; transform:scale(.95); transition:transform .4s ease;
      max-height:85vh; overflow-y:auto; -webkit-overflow-scrolling:touch;
    }
    .modal.active .modal-card{ transform:scale(1); }
    .modal-card .modal-close{ color:#000; opacity:.7; transition:opacity .3s; }
    .modal-card .modal-close:hover{ opacity:1; }
    .modal-icon-img{ filter:brightness(0); }

    .animated-item{ opacity:0; transform:translateY(20px); }
    .modal.active .animated-item{ animation:slideUp .6s cubic-bezier(.23,1,.32,1) forwards; }
    .modal.active .delay-1{ animation-delay:.2s; }
    .modal.active .delay-2{ animation-delay:.3s; }
    .modal.active .delay-3{ animation-delay:.4s; }
    .modal.active .delay-4{ animation-delay:.5s; }
    .modal.active .delay-5{ animation-delay:.6s; }
    @keyframes slideUp{ to{ opacity:1; transform:translateY(0); } }
    .list-icon{ width:24px; height:24px; filter:brightness(0); }

    /* Плавное переключение десктоп/мобайл (не меняет твою разметку, только мягко гасит сцену) */
    .desktop-stage{ transition:opacity .35s ease; }
    body.mode-mobile .desktop-stage{ opacity:0; pointer-events:none; }
    body.mode-desktop .desktop-stage{ opacity:1; pointer-events:auto; }

    /* Холст фона только внутри мобильного меню */
    #mobile-menu{ position:fixed; overflow:hidden; }
    #mobile-menu .bg-canvas{ position:absolute; inset:0; z-index:0; pointer-events:none; opacity:.85; }
    #mobile-menu > *{ position:relative; z-index:1; }
  </style>
</head>
<body class="bg-black text-white flex flex-col min-h-screen mode-desktop">

  <!-- Магический курсор -->
  <div id="magic-cursor"></div>

  <!-- clipPath для «рваных» кнопок -->
  <svg style="position:absolute;width:0;height:0">
    <defs>
      <clipPath id="torn-paper-shape" clipPathUnits="objectBoundingBox">
        <path d="M0.01 0.1 C0.05 0.12,0.03 0.05,0.1 0.08 L0.2 0.02,0.25 0.06,0.3 0.01,0.4 0.05,0.5 0,0.6 0.06,0.7 0.02,0.8 0.07,0.9 0.03 C0.95 0.05,0.98 0.02,0.99 0.1 L0.98 0.9 C0.95 0.88,0.97 0.95,0.9 0.92 L0.8 0.98,0.75 0.94,0.7 0.99,0.6 0.95,0.5 1,0.4 0.94,0.3 0.98,0.2 0.93,0.1 0.97 C0.05 0.95,0.02 0.98,0.01 0.9 Z"/>
      </clipPath>
    </defs>
  </svg>

  <!-- Бургер (мобайл) -->
  <header class="fixed top-0 right-0 p-4 z-50 md:hidden">
    <button id="menu-toggle" class="text-white" aria-label="Меню">
      <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
      </svg>
    </button>
  </header>

  <!-- Десктопная «сцена»: три большие кнопки + футер -->
  <div class="desktop-stage flex flex-col flex-grow">
    <main class="flex-grow hidden md:flex items-end justify-center pb-12">
      <div class="flex flex-col md:flex-row items-center justify-center gap-8 md:gap-12 p-8">
        <button class="torn-paper-button desktop-button-animation delay-1" data-modal-target="private-events-modal">Частные выступления</button>
        <button class="torn-paper-button desktop-button-animation delay-2" data-modal-target="concert-show-modal">Концертное шоу</button>
        <button class="torn-paper-button desktop-button-animation delay-3" data-modal-target="magic-school-modal">Школа фокусов</button>
      </div>
    </main>

    <div class="flex-grow md:hidden"></div>

    <footer class="w-full p-4 text-gray-400 text-sm flex justify-between items-center">
      <span>© 2025, ИП Костюк. Все права защищены.</span>
      <button class="torn-paper-button footer-button hidden md:block" data-modal-target="about-me-modal">Обо мне</button>
    </footer>
  </div>

  <!-- Мобильное меню (с фоновой анимацией) -->
  <div id="mobile-menu" class="fixed inset-0 bg-black z-40 flex flex-col items-center justify-center gap-8">
    <!-- Canvas с анимацией добавится JS-ом как .bg-canvas -->
    <button class="mobile-menu-button torn-paper-button" data-modal-target="private-events-modal">Частные выступления</button>
    <button class="mobile-menu-button torn-paper-button" data-modal-target="concert-show-modal">Концертное шоу</button>
    <button class="mobile-menu-button torn-paper-button" data-modal-target="magic-school-modal">Школа фокусов</button>
    <button class="mobile-menu-button torn-paper-button" data-modal-target="about-me-modal">Обо мне</button>
  </div>

  <!-- ===== МОДАЛКИ (контент как у тебя) ===== -->

  <!-- Частные выступления -->
  <div id="private-events-modal" class="modal fixed inset-0 bg-black bg-opacity-80 items-center justify-center p-4 z-50" aria-hidden="true">
    <div class="modal-card p-8 sm:p-12 rounded-lg max-w-2xl w-full flex flex-col items-center">
      <div class="animated-item"><img src="icon-wow.png" alt="Wow" class="modal-icon-img w-16 h-16 mb-4"></div>
      <h2 class="animated-item delay-1 text-4xl font-bold mb-2">Частные выступления</h2>
      <p class="animated-item delay-2 text-lg opacity-80 mb-6">Магия для особых событий</p>
      <div class="animated-item delay-3 text-center max-w-md w-full text-base opacity-90">
        <p>Магия вживую на свадьбах, корпоративах и днях рождения. Каждый номер вовлекает гостей и превращает праздник в событие, которое невозможно забыть.</p>
      </div>
      <!-- Кнопка-ссылка -->
      <a class="animated-item delay-4 torn-paper-button button-inverted mt-8 text-xl px-6"
         href="https://site76-git-main-demonnikkos-projects.vercel.app" target="_blank" rel="noopener">Заказать шоу</a>
      <button class="modal-close absolute top-4 right-4 text-3xl font-light" aria-label="Закрыть">&times;</button>
    </div>
  </div>

  <!-- Концертное шоу -->
  <div id="concert-show-modal" class="modal fixed inset-0 bg-black bg-opacity-80 items-center justify-center p-4 z-50" aria-hidden="true">
    <div class="modal-card p-8 sm:p-12 rounded-lg max-w-2xl w-full flex flex-col items-center">
      <div class="animated-item"><img src="icon-masks.png" alt="Театральные маски" class="modal-icon-img w-16 h-16 mb-4"></div>
      <h2 class="animated-item delay-1 text-4xl font-bold mb-2">Шоу «Секрет»</h2>
      <p class="animated-item delay-2 text-lg opacity-80 mb-6">Философский спектакль-иллюзия</p>
      <div class="animated-item delay-3 text-center max-w-md w-full text-base opacity-90">
        <p>Зрители погружаются в мир загадок, где каждый номер скрывает смысл, а финал переворачивает восприятие.</p>
      </div>
      <a class="animated-item delay-4 torn-paper-button button-inverted mt-8 text-xl px-6"
         href="https://quicktickets.ru/yaroslavl-illyuzionist-dmitrij-kostyuk/s2" target="_blank" rel="noopener">Купить билет</a>
      <button class="modal-close absolute top-4 right-4 text-3xl font-light" aria-label="Закрыть">&times;</button>
    </div>
  </div>

  <!-- Школа фокусов -->
  <div id="magic-school-modal" class="modal fixed inset-0 bg-black bg-opacity-80 items-center justify-center p-4 z-50" aria-hidden="true">
    <div class="modal-card p-8 sm:p-12 rounded-lg max-w-2xl w-full flex flex-col items-center">
      <div class="animated-item"><img src="icon-wand.png" alt="Волшебная палочка" class="modal-icon-img w-16 h-16 mb-4"></div>
      <h2 class="animated-item delay-1 text-4xl font-bold mb-2">Школа фокусов</h2>
      <p class="animated-item delay-2 text-lg opacity-80 mb-6">Первая в Ярославле</p>
      <div class="animated-item delay-3 text-center max-w-md w-full text-base opacity-90">
        <p>Здесь дети учатся не просто трюкам, а уверенности, артистизму и работе на сцене. Каждый проходит путь от первого фокуса до настоящего выступления, а лучшие смогут участвовать в Чемпионате России по фокусам.</p>
      </div>
      <a class="animated-item delay-4 torn-paper-button button-inverted mt-8 text-xl px-6"
         href="https://magic-school-eight.vercel.app" target="_blank" rel="noopener">Записаться на бесплатный урок</a>
      <button class="modal-close absolute top-4 right-4 text-3xl font-light" aria-label="Закрыть">&times;</button>
    </div>
  </div>

  <!-- Обо мне (с фотографией и длинным текстом — как в твоём коде) -->
  <div id="about-me-modal" class="modal fixed inset-0 bg-black bg-opacity-80 items-center justify-center p-4 z-50" aria-hidden="true">
    <div class="modal-card p-8 sm:p-12 rounded-lg max-w-4xl w-full">
      <div class="flex flex-col md:flex-row gap-8 items-center text-left">
        <div class="w-full md:w-1/3 flex-shrink-0 animated-item">
          <img src="photo.jpeg" alt="Дмитрий Костюк" class="rounded-lg object-cover w-full h-full shadow-lg">
        </div>
        <div class="w-full md:w-2/3">
          <h2 class="animated-item delay-1 text-4xl font-bold mb-1">Дмитрий Костюк</h2>
          <p class="animated-item delay-2 text-lg opacity-80 mb-6">иллюзионист, автор шоу и основатель KOSTYUK PROJECT</p>
          <div class="animated-item delay-3 text-base opacity-90 space-y-4">
            <p>Я занимаюсь иллюзионным искусством более 10 лет и создал собственный мир, где магия становится частью жизни. Мои проекты объединены в экосистему KOSTYUK PROJECT, в которую входят:</p>
            <ul class="list-none space-y-3 !mt-4">
              <li class="flex items-start">
                <img src="list-icon-show.png" class="list-icon mr-3 flex-shrink-0" alt="Иконка Шоу">
                <div class="text-left"><b>Шоу «Секрет»</b> — философский театральный спектакль, где каждый номер раскрывает тайну человеческого восприятия.</div>
              </li>
              <li class="flex items-start">
                <img src="list-icon-school.png" class="list-icon mr-3 flex-shrink-0" alt="Иконка Школы">
                <div class="text-left"><b>Школа фокусов</b> — первая в Ярославле образовательная программа, где дети учатся не просто трюкам, а уверенности, артистизму и работе на сцене.</div>
              </li>
              <li class="flex items-start">
                <img src="list-icon-private.png" class="list-icon mr-3 flex-shrink-0" alt="Иконка Частных выступлений">
                <div class="text-left"><b>Частные выступления</b> — магия для особых событий: свадьбы, корпоративы, юбилеи, дни рождения.</div>
              </li>
            </ul>
            <p>Каждое направление решает свою задачу, но все они связаны одной идеей: магия — это не только иллюзия, это способ вдохновлять людей, раскрывать их внутренний потенциал и дарить незабываемые эмоции.</p>
            <p>Моя миссия — делать так, чтобы каждый зритель и ученик чувствовал себя частью чуда.</p>
          </div>
        </div>
      </div>
      <div class="w-full text-center mt-8 md:hidden animated-item delay-4">
        <button id="open-main-menu-from-about" class="torn-paper-button button-inverted text-xl px-8">Меню</button>
      </div>
      <button class="modal-close absolute top-4 right-4 text-3xl font-light" aria-label="Закрыть">&times;</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const modalOpenButtons = document.querySelectorAll('[data-modal-target]');
      const modalCloseButtons = document.querySelectorAll('.modal-close');
      const mobileMenu = document.getElementById('mobile-menu');
      const menuToggle  = document.getElementById('menu-toggle');
      const mobileMenuButtons = document.querySelectorAll('.mobile-menu-button');
      const aboutModal = document.getElementById('about-me-modal');
      const openMainMenuBtn = document.getElementById('open-main-menu-from-about');
      const bodyEl = document.body;

      /* ===== Переключение modes + автопоказ "Обо мне" на мобиле ===== */
      function setMode(){
        const mobile = window.innerWidth < 768;
        bodyEl.classList.toggle('mode-mobile', mobile);
        bodyEl.classList.toggle('mode-desktop', !mobile);
        if(!mobile){
          mobileMenu.classList.remove('active');
          if(aboutModal) aboutModal.classList.remove('active');
        }else{
          // автопоказ «Обо мне» только один раз за сессию
          if(!sessionStorage.getItem('aboutShown') && aboutModal){
            aboutModal.classList.add('active');
            sessionStorage.setItem('aboutShown','1');
          }
        }
      }
      setMode();
      let rId=0; window.addEventListener('resize', ()=>{ cancelAnimationFrame(rId); rId=requestAnimationFrame(setMode); });

      /* Бургер */
      menuToggle.addEventListener('click', () => { mobileMenu.classList.toggle('active'); });

      /* Открытие модалок с главных/мобильных кнопок */
      function openModalById(id){
        const modal = document.getElementById(id);
        if(!modal) return;
        modal.classList.add('active');
      }
      modalOpenButtons.forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const id = btn.dataset.modalTarget;
          openModalById(id);
          // при открытии модалки с моб-меню — закрываем меню
          mobileMenu.classList.remove('active');
        });
      });
      mobileMenuButtons.forEach(button=>{
        button.addEventListener('click', ()=>{ mobileMenu.classList.remove('active'); });
      });

      /* Закрытие модалок */
      modalCloseButtons.forEach(button=>{
        button.addEventListener('click', ()=>{
          const modal = button.closest('.modal'); if(modal) modal.classList.remove('active');
        });
      });
      document.querySelectorAll('.modal').forEach(modal=>{
        modal.addEventListener('click', (e)=>{ if(e.target===modal){ modal.classList.remove('active'); } });
      });

      /* Кнопка «Меню» из модалки «Обо мне» на мобиле */
      if(openMainMenuBtn){
        openMainMenuBtn.addEventListener('click', ()=>{
          if(aboutModal) aboutModal.classList.remove('active');
          if(mobileMenu) mobileMenu.classList.add('active');
        });
      }

      /* Магический курсор + след */
      const magicCursor = document.getElementById('magic-cursor');
      let throttle = false;
      if (window.matchMedia('(pointer: fine)').matches) {
        window.addEventListener('mousemove', e => {
          magicCursor.style.left = e.clientX + 'px';
          magicCursor.style.top  = e.clientY + 'px';
          if (!throttle) {
            createTrailParticle(e.clientX, e.clientY);
            throttle = true; setTimeout(() => throttle = false, 50);
          }
        });
      } else {
        magicCursor.style.display = 'none';
      }
      function createTrailParticle(x, y){
        const p=document.createElement('div');
        p.className='trail-particle';
        const size=Math.random()*8+2;
        p.style.width=size+'px'; p.style.height=size+'px';
        p.style.left=x+'px'; p.style.top=y+'px';
        p.style.transform=`translate(-50%,-50%) translate(${Math.random()*20-10}px,${Math.random()*20-10}px)`;
        document.body.appendChild(p); setTimeout(()=>p.remove(),700);
      }

      /* ===== Фоновая анимация в мобильном меню ===== */
      (function(){
        const host = mobileMenu;
        const isMobile = ()=> window.innerWidth < 768;
        let stopAnim = null;

        const watch = () => {
          const opened = host.classList.contains('active');
          if (opened && isMobile() && !stopAnim) stopAnim = startBgAnim(host);
          else if ((!opened || !isMobile()) && stopAnim) { stopAnim(); stopAnim=null; }
        };
        const mo = new MutationObserver(watch);
        mo.observe(host, {attributes:true, attributeFilter:['class']});
        watch();
        window.addEventListener('resize', watch);

        function startBgAnim(container){
          const cvs=document.createElement('canvas');
          cvs.className='bg-canvas';
          container.prepend(cvs);
          const ctx=cvs.getContext('2d');
          const DPR=Math.max(1, Math.min(2, window.devicePixelRatio||1));
          let w=0,h=0,rafId=0,last=0;

          function resize(){
            const r=container.getBoundingClientRect();
            w=Math.max(1, Math.round(r.width));
            h=Math.max(1, Math.round(r.height));
            cvs.width=Math.round(w*DPR); cvs.height=Math.round(h*DPR);
            cvs.style.width=w+'px'; cvs.style.height=h+'px';
            ctx.setTransform(DPR,0,0,DPR,0,0);
          }
          resize();

          const CELLS_X=4, CELLS_Y=5, MAX_SPRITES=12;
          const TYPES=['dice','wand','qm'];
          const sprites=[], cells=[];
          for(let ix=0;ix<CELLS_X;ix++) for(let iy=0;iy<CELLS_Y;iy++) cells.push({ix,iy});
          for(let i=cells.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [cells[i],cells[j]]=[cells[j],cells[i]]; }
          const count=Math.min(MAX_SPRITES,cells.length);
          for(let i=0;i<count;i++){
            const {ix,iy}=cells[i];
            const cellW=w/CELLS_X, cellH=h/CELLS_Y;
            const x=(ix+0.5)*cellW + (Math.random()-0.5)*cellW*0.35;
            const y=(iy+0.5)*cellH + (Math.random()-0.5)*cellH*0.35;
            const type=TYPES[i%TYPES.length];
            const base=Math.min(w,h);
            const size=Math.max(18, Math.min(48, rand(base*0.05, base*0.085)));
            const speed=rand(12,22);
            const ang=rand(0,Math.PI*2);
            const vx=Math.cos(ang)*speed, vy=Math.sin(ang)*speed;
            const vr=(rand(-15,15)*Math.PI/180);
            const s={type,x,y,vx,vy,r:rand(0,Math.PI*2),vr,size,t:rand(0,1000)};
            if(type==='dice') s.val=(Math.random()*6|0)+1;
            sprites.push(s);
          }

          function tick(ts){
            rafId=requestAnimationFrame(tick);
            if(!last) last=ts;
            const dtMs=ts-last; if(dtMs<1000/58) return; last=ts;
            const dt=dtMs/1000;
            ctx.clearRect(0,0,w,h);
            sprites.forEach(s=>{
              s.t+=dt;
              const driftX=Math.sin(s.t*0.6)*6;
              const driftY=Math.cos(s.t*0.5)*6;
              s.x+=s.vx*dt + driftX*dt;
              s.y+=s.vy*dt + driftY*dt;
              s.r+=s.vr*dt;
              const pad=60;
              if(s.x<-pad) s.x=w+pad; if(s.x>w+pad) s.x=-pad;
              if(s.y<-pad) s.y=h+pad; if(s.y>h+pad) s.y=-pad;
              ctx.save(); ctx.translate(s.x,s.y); ctx.rotate(s.r);
              if(s.type==='wand') drawWand(ctx,s.size);
              else if(s.type==='dice') drawDice(ctx,s.size,s.val);
              else drawQuestion(ctx,s.size);
              ctx.restore();
            });
          }

          function drawWand(ctx,size){
            const len=size*1.8, thick=Math.max(2,size*0.12);
            ctx.fillStyle='#fff';
            ctx.fillRect(-len/2,-thick/2,len,thick);
            ctx.beginPath(); ctx.arc(len/2,0,thick*0.9,0,Math.PI*2); ctx.fill();
          }
          function drawDice(ctx,size,val){
            const s=size, r=Math.min(10,s*0.28);
            const grd=ctx.createLinearGradient(-s/2,-s/2,s/2,s/2);
            grd.addColorStop(0,'#c0a062'); grd.addColorStop(1,'#a18041');
            roundRect(ctx,-s/2,-s/2,s,s,r); ctx.fillStyle=grd; ctx.fill();
            ctx.lineWidth=1; ctx.strokeStyle='rgba(0,0,0,.25)'; ctx.stroke();
            ctx.fillStyle='#111';
            const d=s/6; const dot=(dx,dy)=>{ ctx.beginPath(); ctx.arc(dx,dy,Math.max(1.6,s*0.08),0,Math.PI*2); ctx.fill(); };
            ({
              1:[[0,0]],
              2:[[-d,-d],[d,d]],
              3:[[-d,-d],[0,0],[d,d]],
              4:[[-d,-d],[-d,d],[d,-d],[d,d]],
              5:[[-d,-d],[-d,d],[0,0],[d,-d],[d,d]],
              6:[[-d,-d],[-d,0],[-d,d],[d,-d],[d,0],[d,d]]
            }[val||1]).forEach(([dx,dy])=>dot(dx,dy));
          }
          function drawQuestion(ctx,size){
            ctx.fillStyle='#ff2b2b';
            ctx.textAlign='center'; ctx.textBaseline='middle';
            ctx.font=`${Math.round(size*1.6)}px "Playfair Display", serif`;
            ctx.fillText('?',0,0);
            ctx.save(); ctx.globalAlpha=.25; ctx.fillText('?',1.5,1.5); ctx.restore();
          }
          function roundRect(ctx,x,y,w,h,r){
            const rr=Math.min(r,w/2,h/2);
            ctx.beginPath();
            ctx.moveTo(x+rr,y);
            ctx.arcTo(x+w,y,x+w,y+h,rr);
            ctx.arcTo(x+w,y+h,x,y+h,rr);
            ctx.arcTo(x,y+h,x,y,rr);
            ctx.arcTo(x,y,x+w,y,rr);
            ctx.closePath();
          }

          const ro=new ResizeObserver(resize); ro.observe(container);
          rafId=requestAnimationFrame(tick);

          return function stop(){ cancelAnimationFrame(rafId); ro.disconnect(); cvs.remove(); };
        }

        function rand(a,b){ return a+Math.random()*(b-a); }
      })();
    });
  </script>
</body>
</html>
